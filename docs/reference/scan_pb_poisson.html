<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculate the population-based Poisson scan statistic devised by Kulldorff
(1997, 2001)."><title>Calculate the population-based Poisson scan statistic. — scan_pb_poisson • scanstatistics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate the population-based Poisson scan statistic. — scan_pb_poisson"><meta property="og:description" content="Calculate the population-based Poisson scan statistic devised by Kulldorff
(1997, 2001)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">scanstatistics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/make_data.html">Process data</a>
    <a class="dropdown-item" href="../articles/introduction.html">Introduction to scanstatistics</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/promerpr/scanstatistics/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculate the population-based Poisson scan statistic.</h1>
      <small class="dont-index">Source: <a href="https://github.com/promerpr/scanstatistics/blob/HEAD/R/scan_pb_poisson.R" class="external-link"><code>R/scan_pb_poisson.R</code></a></small>
      <div class="d-none name"><code>scan_pb_poisson.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate the population-based Poisson scan statistic devised by Kulldorff
(1997, 2001).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">scan_pb_poisson</span><span class="op">(</span>
  <span class="va">counts</span>,
  <span class="va">zones</span>,
  population <span class="op">=</span> <span class="cn">NULL</span>,
  n_mcsim <span class="op">=</span> <span class="fl">0</span>,
  gumbel <span class="op">=</span> <span class="cn">FALSE</span>,
  max_only <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>counts</dt>
<dd><p>Either:</p><ul><li><p>A matrix of observed counts. Rows indicate time and are ordered
        from least recent (row 1) to most recent (row 
        <code>nrow(counts)</code>). Columns indicate locations, numbered from 1 
        and up. If <code>counts</code> is a matrix, the optional argument 
        <code>population</code> should also be specified.</p></li>
<li><p>A data frame with columns "time", "location", "count", 
        "population".</p></li>
</ul></dd>
<dt>zones</dt>
<dd><p>A list of integer vectors. Each vector corresponds to a single
zone; its elements are the numbers of the locations in that zone.</p></dd>
<dt>population</dt>
<dd><p>Optional. A matrix or vector of populations for each 
location and time point. Only needed if <code>baselines</code> are to be 
estimated and you want to account for the different populations in each 
location (and time). If a matrix, should be of the same dimensions as 
<code>counts</code>. If a vector, should be of the same length as the number of 
columns in <code>counts</code> (the number of locations).</p></dd>
<dt>n_mcsim</dt>
<dd><p>A non-negative integer; the number of replicate scan
statistics to generate in order to calculate a P-value.</p></dd>
<dt>gumbel</dt>
<dd><p>Logical: should a Gumbel P-value be calculated? Default is
<code>FALSE</code>.</p></dd>
<dt>max_only</dt>
<dd><p>Boolean. If <code>FALSE</code> (default) the log-likelihood ratio
statistic for each zone and duration is returned. If <code>TRUE</code>, only the
largest such statistic (i.e. the scan statistic) is returned, along with
the corresponding zone and duration.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list which, in addition to the information about the type of scan
   statistic, has the following components:</p><dl><dt>MLC</dt>
<dd><p>A list containing the number of the zone of the most likely
           cluster (MLC), the locations in that zone, the duration of the 
           MLC, the calculated score, and the relative risk inside and 
           outside the cluster. In order, the elements of this list are named  
           <code>zone_number, locations, duration, score, relrisk_in,
           relrisk_out</code>.</p></dd>

     <dt>observed</dt>
<dd><p>A data frame containing, for each combination of zone 
           and duration investigated, the zone number, duration, score, 
           relative risks. The table is sorted by score with the top-scoring 
           location on top. If <code>max_only = TRUE</code>, only contains a single 
           row corresponding to the MLC.</p></dd>

     <dt>replicates</dt>
<dd><p>A data frame of the Monte Carlo replicates of the scan 
           statistic (if any), and the corresponding zones and durations.</p></dd>

     <dt>MC_pvalue</dt>
<dd><p>The Monte Carlo \(P\)-value.</p></dd>

     <dt>Gumbel_pvalue</dt>
<dd><p>A \(P\)-value obtained by fitting a Gumbel 
           distribution to the replicate scan statistics.</p></dd>

     <dt>n_zones</dt>
<dd><p>The number of zones scanned.</p></dd>

     <dt>n_locations</dt>
<dd><p>The number of locations.</p></dd>

     <dt>max_duration</dt>
<dd><p>The maximum duration considered.</p></dd>

     <dt>n_mcsim</dt>
<dd><p>The number of Monte Carlo replicates made.</p></dd>

   
</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kulldorff, M. (1997). <em>A spatial scan statistic</em>. Communications in 
   Statistics - Theory and Methods, 26, 1481–1496.</p>   
<p>Kulldorff, M. (2001). <em>Prospective time periodic geographical disease 
   surveillance using a scan statistic</em>. Journal of the Royal Statistical 
   Society, Series A (Statistics in Society), 164, 61–72.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Create location coordinates, calculate nearest neighbors, and create zones</span></span>
<span class="r-in"><span class="va">n_locs</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span class="r-in"><span class="va">max_duration</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span class="r-in"><span class="va">n_total</span> <span class="op">&lt;-</span> <span class="va">n_locs</span> <span class="op">*</span> <span class="va">max_duration</span></span>
<span class="r-in"><span class="va">geo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_locs</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>, <span class="va">n_locs</span>, <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">knn_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="coords_to_knn.html">coords_to_knn</a></span><span class="op">(</span><span class="va">geo</span>, <span class="fl">15</span><span class="op">)</span></span>
<span class="r-in"><span class="va">zones</span> <span class="op">&lt;-</span> <span class="fu"><a href="knn_zones.html">knn_zones</a></span><span class="op">(</span><span class="va">knn_mat</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Simulate data</span></span>
<span class="r-in"><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_total</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>, <span class="va">max_duration</span>, <span class="va">n_locs</span><span class="op">)</span></span>
<span class="r-in"><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n_total</span>, <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span> <span class="op">/</span> <span class="fl">20</span><span class="op">)</span>, </span>
<span class="r-in">                 <span class="va">max_duration</span>, <span class="va">n_locs</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Inject outbreak/event/anomaly</span></span>
<span class="r-in"><span class="va">ob_dur</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span class="r-in"><span class="va">ob_cols</span> <span class="op">&lt;-</span> <span class="va">zones</span><span class="op">[[</span><span class="fl">10</span><span class="op">]</span><span class="op">]</span></span>
<span class="r-in"><span class="va">ob_rows</span> <span class="op">&lt;-</span> <span class="va">max_duration</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">ob_dur</span><span class="op">)</span></span>
<span class="r-in"><span class="va">counts</span><span class="op">[</span><span class="va">ob_rows</span>, <span class="va">ob_cols</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">ob_dur</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ob_cols</span><span class="op">)</span>, <span class="fl">2</span> <span class="op">*</span> <span class="va">population</span><span class="op">[</span><span class="va">ob_rows</span>, <span class="va">ob_cols</span><span class="op">]</span> <span class="op">/</span> <span class="fl">20</span><span class="op">)</span>, </span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ob_rows</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ob_cols</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">scan_pb_poisson</span><span class="op">(</span>counts <span class="op">=</span> <span class="va">counts</span>,</span>
<span class="r-in">                       zones <span class="op">=</span> <span class="va">zones</span>,</span>
<span class="r-in">                       population <span class="op">=</span> <span class="va">population</span>,</span>
<span class="r-in">                       n_mcsim <span class="op">=</span> <span class="fl">99</span>,</span>
<span class="r-in">                       max_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Benjamin Allévius, Paul Romer Present.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

